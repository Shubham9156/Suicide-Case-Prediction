# -*- coding: utf-8 -*-
"""SuicidesInIndia.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1kW6mMrXKCSGjmt_7k0t5WqDdy_MeY5qh

**Import Packages**
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

"""**Read CSV File**"""

data = pd.read_csv('Suicidesindia2001-2012.csv')
data

data.shape

data.info()

data.isnull().sum()

"""**Total Suicides in India**"""

data['Total']

data.Total

data.iloc[:,6]

data.loc[:,'Total']

data.Total.sum()

"""**Total Suicides in India States Wise**"""

index = data['State']=='Punjab'
data[index].Total.sum()

data.groupby('State').Total.sum().sort_values(ascending=False)

"""**Total Suicides in India Year Wise**"""

D = data.groupby('Year').Total.sum()
D

x = D.index.values
y = D.values

plt.scatter(x,y)
plt.show()

"""**Total Suicides in India Gender Wise**"""

data.groupby('Gender').Total.sum()

"""**Total Suicides in India State-Year Wise**"""

data.groupby(['State','Year']).Total.sum()

data.groupby(['State','Year'])[['Total']].sum().to_html('index.html')
data.groupby(['State','Year'])[['Total']].sum().to_html('index.csv')

"""**Total Suicides in India State-Gender Wise**"""

data.groupby(['State','Gender'])[['Total']].sum()

"""**Total Suicides in India Year-Gender Wise**"""

data.groupby(['Year','Gender'])[['Total']].sum()

"""**Total Suicides in India State-Year-Gender Wise**"""

data.groupby(['State','Year','Gender'])[['Total']].sum().to_html('index.html')

data.groupby('Type').Total.sum().sort_values(ascending=False)

"""**Machine Learning**"""

D = data.groupby('Year').Total.sum()
D

x = D.index.values.reshape(-1,1)
x

y = D.values
y

plt.scatter(x,y)
plt.xlabel('Year')
plt.ylabel('Total Suicides')
plt.show()

from sklearn.linear_model import LinearRegression
reg = LinearRegression()
reg.fit(x,y)

reg.coef_

reg.intercept_

y

Yp = reg.predict(x)
Yp

plt.scatter(x,y)
plt.plot(x,Yp)
plt.show()

reg.score(x,y) * 100

"""**2022 Suicide Case Prediction**"""

reg.predict([[2022]])

"""**Polynomial Regression**"""

x

y

from sklearn.preprocessing import PolynomialFeatures
poly = PolynomialFeatures(degree=5)
X = poly.fit_transform(x)
pd.DataFrame(X)

from sklearn.linear_model import LinearRegression
reg = LinearRegression()
reg.fit(X,y)

reg.coef_

reg.intercept_

x

y

Yp = reg.predict(X)
Yp

plt.scatter(x,y)
plt.plot(x,Yp)
plt.show()

reg.score(X,y) * 100

val = poly.transform([[2022]])
val

"""**Final Prediction**"""

reg.predict(val)

